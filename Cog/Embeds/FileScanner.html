<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Cog::Embeds::FileScanner
  
    &mdash; Documentation by YARD 0.8.3
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../';
  framesUrl = "../../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (F)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Cog.html" title="Cog (module)">Cog</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Embeds.html" title="Cog::Embeds (module)">Embeds</a></span></span>
     &raquo; 
    <span class="title">FileScanner</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: Cog::Embeds::FileScanner
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Cog::Embeds::FileScanner</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/cog/embeds/file_scanner.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Helper for scanning files for embed expansions</p>


  </div>
</div>
<div class="tags">
  

</div>



  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#marked_line_number-instance_method" title="#marked_line_number (instance method)">- (Fixnum) <strong>marked_line_number</strong> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Line number where mark! was called or -1 if mark! was not called.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#capture_until-instance_method" title="#capture_until (instance method)">- (Boolean) <strong>capture_until</strong>(pattern, opt = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Advances the file until the given pattern is encountered and captures lines
as it reads.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#captured_text-instance_method" title="#captured_text (instance method)">- (String) <strong>captured_text</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Text captured during capture_until.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#close-instance_method" title="#close (instance method)">- (Object) <strong>close</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Closes the scanned file, if it is not already closed.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (FileScanner) <strong>initialize</strong>(filename) </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of FileScanner.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#insert_at_mark-instance_method" title="#insert_at_mark (instance method)">- (Boolean) <strong>insert_at_mark</strong>(value) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Whether or not the operation succeeded.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#mark%21-instance_method" title="#mark! (instance method)">- (nil) <strong>mark!</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Remember this position.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#read_until-instance_method" title="#read_until (instance method)">- (MatchData<sup>?</sup>) <strong>read_until</strong>(pattern, n = 0) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Advances the file until the (n+1)th occurence of the given pattern is
encountered, or the end of the file is reached.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#readline_matches%3F-instance_method" title="#readline_matches? (instance method)">- (Boolean) <strong>readline_matches?</strong>(pattern) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Advances the file by one line.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#replace_captured_text-instance_method" title="#replace_captured_text (instance method)">- (Boolean) <strong>replace_captured_text</strong>(value, opt = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Whether or not the operation succeeded.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unmark%21-instance_method" title="#unmark! (instance method)">- (Object) <strong>unmark!</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Cog::Embeds::FileScanner (class)">FileScanner</a></span></tt>) <strong>initialize</strong>(filename) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>A new instance of FileScanner</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


7
8
9
10
11
12
13
14</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cog/embeds/file_scanner.rb', line 7</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='rubyid_filename identifier id'>filename</span><span class='rparen token'>)</span>
  <span class='rubyid_@filename ivar id'>@filename</span> <span class='assign token'>=</span> <span class='rubyid_filename identifier id'>filename</span>
  <span class='rubyid_@f ivar id'>@f</span> <span class='assign token'>=</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_open identifier id'>open</span> <span class='rubyid_filename identifier id'>filename</span><span class='comma token'>,</span> <span class='string val'>'r'</span>
  <span class='rubyid_@lines ivar id'>@lines</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='rubyid_@mark ivar id'>@mark</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
  <span class='rubyid_@cap_begin_pos ivar id'>@cap_begin_pos</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
  <span class='rubyid_@cap_end_pos ivar id'>@cap_end_pos</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="marked_line_number-instance_method">
  
    - (<tt>Fixnum</tt>) <strong>marked_line_number</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Line number where mark! was called or -1 if mark! was not called</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Fixnum</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>line number where mark! was called or -1 if mark! was not called</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


34
35
36</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cog/embeds/file_scanner.rb', line 34</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_marked_line_number identifier id'>marked_line_number</span>
  <span class='rubyid_@marked_line_number ivar id'>@marked_line_number</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="capture_until-instance_method">
  
    - (<tt>Boolean</tt>) <strong>capture_until</strong>(pattern, opt = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Advances the file until the given pattern is encountered and captures lines
as it reads. The line which matches the pattern will not be captured.
Captured lines can later be recovered with captured_text</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>pattern</span>
      
      
        <span class='type'>(<tt>Regexp</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a pattern to test for</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opt</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>a customizable set of options</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>opt</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:but_not</span>
          <span class="type">(<tt>Array&lt;Regexp&gt;</tt>, <tt>Regexp</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>nil</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>if a line matching any of the provided patterns is found before the desired
pattern :bad_pattern_found will be thrown</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>whether or not the pattern was found</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cog/embeds/file_scanner.rb', line 68</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_capture_until identifier id'>capture_until</span><span class='lparen token'>(</span><span class='rubyid_pattern identifier id'>pattern</span><span class='comma token'>,</span> <span class='rubyid_opt identifier id'>opt</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='rubyid_@cap_begin_pos ivar id'>@cap_begin_pos</span> <span class='assign token'>=</span> <span class='rubyid_@f ivar id'>@f</span><span class='dot token'>.</span><span class='rubyid_pos identifier id'>pos</span>
  <span class='rubyid_but_not identifier id'>but_not</span> <span class='assign token'>=</span> <span class='rubyid_opt identifier id'>opt</span><span class='lbrack token'>[</span><span class='symbol val'>:but_not</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='rubyid_but_not identifier id'>but_not</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rubyid_but_not identifier id'>but_not</span><span class='rbrack token'>]</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_but_not identifier id'>but_not</span><span class='dot token'>.</span><span class='rubyid_is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='rubyid_Array constant id'>Array</span><span class='rparen token'>)</span>
  <span class='rubyid_while while kw'>while</span> <span class='rubyid_line identifier id'>line</span> <span class='assign token'>=</span> <span class='rubyid_@f ivar id'>@f</span><span class='dot token'>.</span><span class='rubyid_readline identifier id'>readline</span>
    <span class='rubyid_but_not identifier id'>but_not</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_bad_pattern identifier id'>bad_pattern</span><span class='bitor op'>|</span>
      <span class='rubyid_if if kw'>if</span> <span class='rubyid_bad_pattern identifier id'>bad_pattern</span> <span class='match op'>=~</span> <span class='rubyid_line identifier id'>line</span>
        <span class='rubyid_return return kw'>return</span> <span class='rubyid_false false kw'>false</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_return return kw'>return</span> <span class='rubyid_true true kw'>true</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_line identifier id'>line</span> <span class='match op'>=~</span> <span class='rubyid_pattern identifier id'>pattern</span>
    <span class='rubyid_@lines ivar id'>@lines</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_line identifier id'>line</span>
    <span class='rubyid_@cap_end_pos ivar id'>@cap_end_pos</span> <span class='assign token'>=</span> <span class='rubyid_@f ivar id'>@f</span><span class='dot token'>.</span><span class='rubyid_pos identifier id'>pos</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_rescue rescue kw'>rescue</span> <span class='rubyid_EOFError constant id'>EOFError</span>
  <span class='rubyid_false false kw'>false</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="captured_text-instance_method">
  
    - (<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>) <strong>captured_text</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Text captured during capture_until. The last newline is stripped</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>text captured during capture_until. The last newline is stripped</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


87
88
89
90
91</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cog/embeds/file_scanner.rb', line 87</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_captured_text identifier id'>captured_text</span>
  <span class='rubyid_x identifier id'>x</span> <span class='assign token'>=</span> <span class='rubyid_@lines ivar id'>@lines</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>''</span><span class='rparen token'>)</span>
  <span class='rubyid_x identifier id'>x</span> <span class='assign token'>=</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_slice identifier id'>slice</span><span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>-2</span><span class='rparen token'>)</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_x identifier id'>x</span> <span class='match op'>=~</span> <span class='regexp val'>/\n$/</span>
  <span class='rubyid_x identifier id'>x</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="close-instance_method">
  
    - (<tt>Object</tt>) <strong>close</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Closes the scanned file, if it is not already closed</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


17
18
19</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cog/embeds/file_scanner.rb', line 17</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_close identifier id'>close</span>
  <span class='rubyid_@f ivar id'>@f</span><span class='dot token'>.</span><span class='rubyid_close identifier id'>close</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_@f ivar id'>@f</span><span class='dot token'>.</span><span class='rubyid_closed? fid id'>closed?</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="insert_at_mark-instance_method">
  
    - (<tt>Boolean</tt>) <strong>insert_at_mark</strong>(value) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Whether or not the operation succeeded</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>value</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>value to be inserted into the file at the current position</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>whether or not the operation succeeded</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


112
113
114
115
116
117
118
119
120
121
122
123</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cog/embeds/file_scanner.rb', line 112</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_insert_at_mark identifier id'>insert_at_mark</span><span class='lparen token'>(</span><span class='rubyid_value identifier id'>value</span><span class='rparen token'>)</span>
  <span class='rubyid_return return kw'>return</span> <span class='rubyid_false false kw'>false</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_@mark ivar id'>@mark</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
  <span class='rubyid_@f ivar id'>@f</span><span class='dot token'>.</span><span class='rubyid_seek identifier id'>seek</span> <span class='integer val'>0</span>
  <span class='rubyid_tmp identifier id'>tmp</span><span class='dot token'>.</span><span class='rubyid_write identifier id'>write</span> <span class='rubyid_@f ivar id'>@f</span><span class='dot token'>.</span><span class='rubyid_read identifier id'>read</span><span class='lparen token'>(</span><span class='rubyid_@mark ivar id'>@mark</span><span class='rparen token'>)</span>
  <span class='rubyid_tmp identifier id'>tmp</span><span class='dot token'>.</span><span class='rubyid_write identifier id'>write</span> <span class='rubyid_value identifier id'>value</span>
  <span class='rubyid_@f ivar id'>@f</span><span class='dot token'>.</span><span class='rubyid_readline identifier id'>readline</span> <span class='comment val'># discard original</span>
  <span class='rubyid_tmp identifier id'>tmp</span><span class='dot token'>.</span><span class='rubyid_write identifier id'>write</span> <span class='rubyid_@f ivar id'>@f</span><span class='dot token'>.</span><span class='rubyid_read identifier id'>read</span>
  <span class='rubyid_tmp identifier id'>tmp</span><span class='dot token'>.</span><span class='rubyid_close identifier id'>close</span>
  <span class='rubyid_close identifier id'>close</span>
  <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_mv identifier id'>mv</span> <span class='rubyid_tmp_filename identifier id'>tmp_filename</span><span class='comma token'>,</span> <span class='rubyid_@filename ivar id'>@filename</span>
  <span class='rubyid_true true kw'>true</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="mark!-instance_method">
  
    - (<tt>nil</tt>) <strong>mark!</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Remember this position. A later call to insert_at_mark will insert at this
marked position</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


23
24
25
26</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cog/embeds/file_scanner.rb', line 23</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_mark! fid id'>mark!</span>
  <span class='rubyid_@mark ivar id'>@mark</span> <span class='assign token'>=</span> <span class='rubyid_@f ivar id'>@f</span><span class='dot token'>.</span><span class='rubyid_pos identifier id'>pos</span>
  <span class='rubyid_@marked_line_number ivar id'>@marked_line_number</span> <span class='assign token'>=</span> <span class='rubyid_@f ivar id'>@f</span><span class='dot token'>.</span><span class='rubyid_lineno identifier id'>lineno</span> <span class='plus op'>+</span> <span class='integer val'>1</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="read_until-instance_method">
  
    - (<tt>MatchData</tt><sup>?</sup>) <strong>read_until</strong>(pattern, n = 0) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Advances the file until the (n+1)th occurence of the given pattern is
encountered, or the end of the file is reached</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>pattern</span>
      
      
        <span class='type'>(<tt>Regexp</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a pattern to test for</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>n</span>
      
      
        <span class='type'>(<tt>Fixnum</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>0</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>0 for the first, 1 for the second, and so on</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>MatchData</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the match object if the pattern was found</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


40
41
42
43
44
45
46
47
48
49
50
51
52
53</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cog/embeds/file_scanner.rb', line 40</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_read_until identifier id'>read_until</span><span class='lparen token'>(</span><span class='rubyid_pattern identifier id'>pattern</span><span class='comma token'>,</span> <span class='rubyid_n identifier id'>n</span><span class='assign token'>=</span><span class='integer val'>0</span><span class='rparen token'>)</span>
  <span class='rubyid_i identifier id'>i</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='rubyid_mark! fid id'>mark!</span>
  <span class='rubyid_while while kw'>while</span> <span class='lparen token'>(</span><span class='rubyid_line identifier id'>line</span> <span class='assign token'>=</span> <span class='rubyid_@f ivar id'>@f</span><span class='dot token'>.</span><span class='rubyid_readline identifier id'>readline</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='rubyid_i identifier id'>i</span> <span class='leq op'>&lt;=</span> <span class='rubyid_n identifier id'>n</span>
    <span class='rubyid_if if kw'>if</span> <span class='rubyid_m identifier id'>m</span> <span class='assign token'>=</span> <span class='rubyid_pattern identifier id'>pattern</span><span class='dot token'>.</span><span class='rubyid_match identifier id'>match</span><span class='lparen token'>(</span><span class='rubyid_line identifier id'>line</span><span class='rparen token'>)</span>
      <span class='rubyid_return return kw'>return</span> <span class='rubyid_m identifier id'>m</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_i identifier id'>i</span> <span class='eq op'>==</span> <span class='rubyid_n identifier id'>n</span>
      <span class='rubyid_i identifier id'>i</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_mark! fid id'>mark!</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_rescue rescue kw'>rescue</span> <span class='rubyid_EOFError constant id'>EOFError</span>
  <span class='rubyid_unmark! fid id'>unmark!</span>
  <span class='rubyid_nil nil kw'>nil</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="readline_matches?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>readline_matches?</strong>(pattern) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Advances the file by one line</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>pattern</span>
      
      
        <span class='type'>(<tt>Regexp</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a pattern to test for</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>whether or not the next line matched the pattern</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


58
59
60
61
62</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cog/embeds/file_scanner.rb', line 58</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_readline_matches? fid id'>readline_matches?</span><span class='lparen token'>(</span><span class='rubyid_pattern identifier id'>pattern</span><span class='rparen token'>)</span>
  <span class='notop op'>!</span><span class='notop op'>!</span><span class='lparen token'>(</span><span class='rubyid_@f ivar id'>@f</span><span class='dot token'>.</span><span class='rubyid_readline identifier id'>readline</span> <span class='match op'>=~</span> <span class='rubyid_pattern identifier id'>pattern</span><span class='rparen token'>)</span>
<span class='rubyid_rescue rescue kw'>rescue</span> <span class='rubyid_EOFError constant id'>EOFError</span>
  <span class='rubyid_false false kw'>false</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="replace_captured_text-instance_method">
  
    - (<tt>Boolean</tt>) <strong>replace_captured_text</strong>(value, opt = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Whether or not the operation succeeded</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>value</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>value to replace the captured_text with</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opt</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>:once (false) if once, the cog delimiters will be removed</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>whether or not the operation succeeded</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


96
97
98
99
100
101
102
103
104
105
106
107
108</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cog/embeds/file_scanner.rb', line 96</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_replace_captured_text identifier id'>replace_captured_text</span><span class='lparen token'>(</span><span class='rubyid_value identifier id'>value</span><span class='comma token'>,</span> <span class='rubyid_opt identifier id'>opt</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='rubyid_return return kw'>return</span> <span class='rubyid_false false kw'>false</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_@cap_begin_pos ivar id'>@cap_begin_pos</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span> <span class='orop op'>||</span> <span class='rubyid_@cap_end_pos ivar id'>@cap_end_pos</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
  <span class='rubyid_@f ivar id'>@f</span><span class='dot token'>.</span><span class='rubyid_seek identifier id'>seek</span> <span class='integer val'>0</span>
  <span class='rubyid_tmp identifier id'>tmp</span><span class='dot token'>.</span><span class='rubyid_write identifier id'>write</span> <span class='rubyid_@f ivar id'>@f</span><span class='dot token'>.</span><span class='rubyid_read identifier id'>read</span><span class='lparen token'>(</span><span class='rubyid_opt identifier id'>opt</span><span class='lbrack token'>[</span><span class='symbol val'>:once</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='rubyid_@mark ivar id'>@mark</span> <span class='colon op'>:</span> <span class='rubyid_@cap_begin_pos ivar id'>@cap_begin_pos</span><span class='rparen token'>)</span>
  <span class='rubyid_tmp identifier id'>tmp</span><span class='dot token'>.</span><span class='rubyid_write identifier id'>write</span> <span class='rubyid_value identifier id'>value</span>
  <span class='rubyid_@f ivar id'>@f</span><span class='dot token'>.</span><span class='rubyid_seek identifier id'>seek</span> <span class='rubyid_@cap_end_pos ivar id'>@cap_end_pos</span>
  <span class='rubyid_@f ivar id'>@f</span><span class='dot token'>.</span><span class='rubyid_readline identifier id'>readline</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_opt identifier id'>opt</span><span class='lbrack token'>[</span><span class='symbol val'>:once</span><span class='rbrack token'>]</span>
  <span class='rubyid_tmp identifier id'>tmp</span><span class='dot token'>.</span><span class='rubyid_write identifier id'>write</span> <span class='rubyid_@f ivar id'>@f</span><span class='dot token'>.</span><span class='rubyid_read identifier id'>read</span>
  <span class='rubyid_tmp identifier id'>tmp</span><span class='dot token'>.</span><span class='rubyid_close identifier id'>close</span>
  <span class='rubyid_close identifier id'>close</span>
  <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_mv identifier id'>mv</span> <span class='rubyid_tmp_filename identifier id'>tmp_filename</span><span class='comma token'>,</span> <span class='rubyid_@filename ivar id'>@filename</span>
  <span class='rubyid_true true kw'>true</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unmark!-instance_method">
  
    - (<tt>Object</tt>) <strong>unmark!</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


28
29
30
31</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cog/embeds/file_scanner.rb', line 28</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_unmark! fid id'>unmark!</span>
  <span class='rubyid_@mark ivar id'>@mark</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
  <span class='rubyid_@marked_line_number ivar id'>@marked_line_number</span> <span class='assign token'>=</span> <span class='integer val'>-1</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Tue Dec 11 23:39:50 2012 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.3 (ruby-1.8.7).
</div>

  </body>
</html>